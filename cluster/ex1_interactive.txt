#variable definition
USER="ahauser6"
PROJECT="omata"
WORK="/work/PRTNR/UNISANTE/UNISANTE/jriou/ofsp_surveillance/"
PATH1="/users/${USER}/${PROJECT}"

#load python and activate venv
module load gcc python/3.11
#create the venv (only once): python -m venv ${WORK}/jlab_venv311
source ${WORK}/jlab_venv311/bin/activate #source ${WORK}/jlab_venv/bin/activate
which python #check file

#open project folder
cd ${PATH1}

#open (interactive) node
Sinteractive #will give you cpu
#srun --partition=gpu --gres=gpu:1 --cpus-per-task=8 --mem=32G --time=04:00:00 --pty bash #will give you gpu
hostname #name of the node, to exit node type "exit"
free -h #ram info
nvidia-smi #if gpu, gpu info
which python #check which venv is activated
source ${WORK}/jlab_venv311/bin/activate #active it only if needed (see previous line)

#install packages
pip install transformers

#open python
python
import sys
print(sys.executable)
#close with exit()

#open jupyter-lab
jupyter-lab
# close the jupyter-lab with Ctrl-C (in HPC shell)

#SSH tunnel: type in terminal (outside of HPC); ADAPT node (dna064) and port (8889) according to what is written in hpc shell
ssh -n -N -J ahauser6@curnagl.dcsr.unil.ch -L 8889:localhost:8889 ahauser6@dna064




ssh -n -N -J ahauser6@curnagl.dcsr.unil.ch -L 8888:localhost:8888 ahauser6@dnagpu004


# close the tunnel with Ctrl-C (in terminal outside of HPC)



ssh -n -N -J ahauser6@curnagl.dcsr.unil.ch -L 8888:localhost:8888 ahauser6@dnagpu002